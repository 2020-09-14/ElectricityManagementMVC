
@{
    ViewData["Title"] = "Index";
}


@*<link href="~/lib/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />

    <script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>*@
<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" rel="stylesheet">

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="~/lib/moment-with-locales.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>


<div style="width:100%;height:100%;">
   
    4
    <div style="width:100%;height:150px" id="date">

        <div class="row" style="margin-right: 151px;margin-left: 34px;">
            <div>
                <span>运单状态</span>&nbsp;&nbsp;&nbsp;<select id="Select2">
    <option value="">待揽收</option>
    <option value="1">待揽收</option>
    <option value="2">已揽收</option>
    <option value="3">运输中</option>
    <option value="4">派送中</option>
    <option value="5">异常件</option>
    <option value="6">退回件</option>
    <option value="7">退回签收</option>
</select>
                <span>支付方式</span>&nbsp;<select id="Select3">
                    <option value="">请选择支付方式</option>
                    <option value="2">微信</option>
                    <option value="1">支付宝</option>
                </select>&nbsp;&nbsp;
                <span>商品名称</span>&nbsp;<input type="text" placeholder="商品名称" id="goodsname" />&nbsp;&nbsp;<br /><br />
            </div>
            <span>下单时间</span>&nbsp;
            <div class='col-sm-2'>

                <div class="form-group">
                    <!--指定 date标记-->
                    <div class='input-group date' id='datetimepicker1'>

                        <input type='text' class="form-control" id="date1" />
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class='col-sm-2'>
                <div class="form-group">

                    <!--指定 date标记-->
                    <div class='input-group date' id='datetimepicker2'>
                        <input type='text' class="form-control" id="date2" />
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
                    </div>
                </div>
                <div style="margin-left:20px">

                </div>
            </div>
        </div>
        <span>快递公司</span>&nbsp;<select id="Select4"></select>&nbsp;&nbsp;

        <span>收货人</span>&nbsp;
        <input type="text" value="" placeholder="收货人" id="shoupeo">
        
        <span>手机号</span>&nbsp;<input type="text" placeholder="手机号" id="tels" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <span>运单号</span>&nbsp;&nbsp;<input type="text" value="" placeholder="买家昵称" id="deliver">
        <button class="btn btn-info" onclick="Show()" type="button">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-search" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z" />
                <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
            </svg>搜索
        </button>

    </div>
    <input id="Hidden1" value="1" type="hidden" /><input id="Hidden2" value="" type="hidden" />
    <div style="width:100%;height:80%">
        <svg class="bi bi-list-ul" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
        </svg>
        <span>数据列表</span>&nbsp;&nbsp;&nbsp;
    
        <button type="button" class="btn btn-info">

            <span>导出</span>
        </button>&nbsp;&nbsp;&nbsp;
        <button type="button" class="btn btn-info" >

            <span>打印运单信息</span>
        </button>&nbsp;&nbsp;&nbsp;
   
     

        <table class="table">
            <tr style="background-color: #f2f2f2;">
                <th><input type="checkbox" id="all"></th>
                <th>运单号</th>
                <th>生成运单时间</th>
                <th>快递公司</th>
                <th>商品信息</th>
                <th>商品数量</th>
                <th>买家留言</th>
                <th>收货人信息</th>
                <th>运单状态</th>
           

            </tr>
            <tbody id="tb">
            </tbody>

        </table>
        <input type="checkbox" id="alll">全选
        <div style="width:500px;height:200px; margin:0 auto ">
            <input class="btn btn-info dropdown-toggle" id="bu1" type="button" value="上一页" onclick="fist()" />

            <input style="text-align:center" id="bu1" class="btn btn-info dropdown-toggle" type="button" value="下一页" onclick="next()" />
            <select id="Select1" onclick="Show()">
                <option value="3">3</option>
                <option value="6">6</option>
                <option value="9">9</option>
                <option value="12">12</option>
            </select>
        </div>
    </div>
</div>

@*<script src="~/lib/jquery/dist/jquery.js"></script>*@


<script>
    $(function () {
        Show();
        xiala();
        var picker1 = $('#datetimepicker1').datetimepicker({
            format: 'YYYY-MM-DD',
            locale: moment.locale('zh-cn'),
            //minDate: '2016-7-1'
        });
        var picker2 = $('#datetimepicker2').datetimepicker({
            format: 'YYYY-MM-DD',
            locale: moment.locale('zh-cn')
        });
        //动态设置最小值
        picker1.on('dp.change', function (e) {
            picker2.data('DateTimePicker').minDate(e.date);
        });
        //动态设置最大值
        picker2.on('dp.change', function (e) {
            picker1.data('DateTimePicker').maxDate(e.date);
        });
    })

    function Show() {
        var date1d       = $("#date1").val();
        var date2o       = $("#date2").val();
        var state        = $("#Select2").val();
        var paytype      = $("#Select3").val();
        var goodsnames   = $("#goodsname").val();
        var express      = $("#Select4").val();
        var shoupeos     = $("#shoupeo").val();
        var tell         = $("#tels").val();
        var deliver      = $("#deliver").val();

        $.ajax({
            url: "http://localhost:2789/api/Deliver",

            data: {
                begintime: date1d,
                overtime: date2o,
                state: state,
                paytype: paytype,
                goodsname: goodsnames,
                express: express,
                shoupeo: shoupeos,
                tels: tell,
                deliver: deliver,
                page: $("#Hidden1").val(),
                pageSize: $("#Select1").val()
            },
            type: "get",
            dataType: "json",
            success: function (date) {
                $("#Hidden2").val(date.counts);
                $("#tb").empty();
                $.each(date.lists, function (index, item) {
                    var str = '<tr>' +
                        '<td><input id="Checkbox1" type="checkbox"  value=' + item.orderId + ' name="sub" /></td>' +
                        '<td>' + item.wayBillNumber + '</td>' +
                        '<td>' + item.wayBillTime + '</td>' +
                        '<td>' + item.wayBillExpress + '</td>' +
                        '<td>' + '<img src="http://localhost:2789' + item.goodsImg + '" alt="" width="40" height="40" />' + item.goodsName + '&nbsp;' + item.goodsIntroduce + '</td>' +
                        '<td>' + item.goodsNum + '</td>' +
                        '<td>' + item.buyerInfoMess + '</td>' +
                        '<td>' + item.buyerAddressName + '<br/>' + item.buyerAddressTel + '<br/>' + item.buyerAddressInfo+'</td>' +

                        '<td>' + (item.wayBillState === 1 ? "待揽收" : item.wayBillState === 2 ? "已揽收" : item.wayBillState === 3 ? "运输中" : item.wayBillState === 4 ? "派送中" : item.wayBillState === 5 ? "异常件" : item.wayBillState===6?"退回件":"退回签收") + '</td>' +
                        '</tr>'
                    $("#tb").append(str);
                })

            }
        })
    }


    function next() {
        var i = $("#Hidden1").val();//页码
        var j = $("#Select1").val();//页数
        var count = $("#Hidden2").val();//总数据
        var lin = Number(Math.ceil(count / j));

        if (i < lin) {
            $("#Hidden1").val(Number(Number($("#Hidden1").val()) + 1));
        }

        Show();

    }
    function fist() {
        if ($("#Hidden1").val() == "1") {
            $("#Hidden1").val(1);
        }
        else {
            $("#Hidden1").val(Number(Number($("#Hidden1").val()) - 1));
        }
        Show();

    }
     function xiala() {
        $.ajax({
            url: "http://localhost:2789/api/ExperssagesAsync",
            type: "get",
            dataType: "json",
            success: function (date) {
                $("#Select4").empty();
                $.each(date, function (index, item) {
                    var str = '<option value="' + item.eName + '">' + item.eName+'</option>'
                    $("#Select4").append(str);
                })

            }
        })
        }
   
    $("#all").on("click", function () {
        $("input[name='sub']").prop('checked', this.checked);
    });
    $("input[name='sub']").on("click", function () {
        var $sub = $("input[name='sub']");
        $("#all").prop("checked", $sub.length == $sub.filter(":checked").length ? true : false);
    })
    $("#alll").on("click", function () {
        $("input[name='sub']").prop('checked', this.checked);
    });
    $("input[name='sub']").on("click", function () {
        var $sub = $("input[name='sub']");
        $("#alll").prop("checked", $sub.length == $sub.filter(":checked").length ? true : false);
    })
</script>




